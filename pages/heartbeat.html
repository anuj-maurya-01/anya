<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Heartbeat ðŸ’“</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}

html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  font-family:'Poppins',sans-serif;
  background:#000;
}

/* ========== NAVBAR ========== */
.navbar{
  position:fixed;
  top:15px;
  left:50%;
  transform:translateX(-50%);
  width:92%;
  background:rgba(255,255,255,.95);
  backdrop-filter:blur(10px);
  border-radius:40px;
  padding:12px 20px;
  box-shadow:0 6px 20px rgba(0,0,0,.3);
  z-index:1000;
}

.nav-container{
  display:flex;
  align-items:center;
  justify-content:space-between;
}

.logo{
  font-weight:600;
  color:#e91e63;
}

.hamburger{
  display:none;
  flex-direction:column;
  cursor:pointer;
}

.hamburger span{
  width:26px;
  height:3px;
  background:#e91e63;
  margin:4px 0;
  border-radius:4px;
}

.nav-links{
  list-style:none;
  display:flex;
  gap:15px;
  margin:0;
  padding:0;
}

.nav-links a{
  text-decoration:none;
  color:#e91e63;
  font-weight:600;
  padding:8px 12px;
  border-radius:20px;
  transition:.3s;
}

.nav-links a:hover,
.nav-links a.active{
  background:#e91e63;
  color:#fff;
}

/* ===== MOBILE NAV ===== */
@media(max-width:768px){
  .hamburger{display:flex}

  .nav-links{
    position:absolute;
    top:70px;
    left:5%;
    width:90%;
    background:rgba(255,255,255,.98);
    flex-direction:column;
    align-items:center;
    display:none;
    padding:20px 0;
    border-radius:25px;
    box-shadow:0 10px 25px rgba(0,0,0,.35);
  }
  .nav-links.show{display:flex}
}

/* ========== CANVAS ========== */
canvas{
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,.2);
  z-index:1;
}

audio{display:none}
</style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar">
  <div class="nav-container">
    <div class="logo">ðŸ’– Our Heartbeat</div>

    <div class="hamburger" id="hamburger">
      <span></span><span></span><span></span>
    </div>

    <ul class="nav-links" id="navLinks">
      <li><a href="timer.html">Our Time</a></li>
      <li><a href="heartbeat.html" class="active">Our Heartbeat</a></li>
      <li><a href="book.html">Book</a></li>
      <li><a href="messages.html">Messages</a></li>
      <li><a href="dates.html">Dates</a></li>
      <li><a href="moments.html">Cute Moments</a></li>
      <li><a href="dance.html">Dance</a></li>
      <li><a href="letters.html">Letters</a></li>
      <li><a href="confession.html">Confession</a></li>
      <li><a href="chats.html">Chats</a></li>
      <li><a href="qa.html">Q&A</a></li>
    </ul>
  </div>
</nav>

<!-- AUDIO -->
<audio id="hb" src="../assets/audio/heartbeat.mp3" loop></audio>

<!-- CANVAS -->
<canvas id="heart"></canvas>

<script>
/* ===== HAMBURGER ===== */
document.getElementById("hamburger").onclick = () => {
  document.getElementById("navLinks").classList.toggle("show");
};

/* ===== HEART ANIMATION (ORIGINAL STYLE â€“ FIXED) ===== */
window.requestAnimationFrame =
window.requestAnimationFrame ||
window.webkitRequestAnimationFrame ||
window.mozRequestAnimationFrame ||
function(cb){setTimeout(cb,16)};

const canvas = document.getElementById("heart");
const ctx = canvas.getContext("2d");
const audio = document.getElementById("hb");

const isMobile = /android|iphone|ipad|ipod/i.test(navigator.userAgent);
let loaded = false;

/* ---- AUDIO (mobile tap fix) ---- */
function startAudio(){
  audio.volume = 1;
  audio.play().catch(()=>{});
  window.removeEventListener("click", startAudio);
  window.removeEventListener("touchstart", startAudio);
}
window.addEventListener("click", startAudio);
window.addEventListener("touchstart", startAudio);

function init(){
if(loaded) return;
loaded = true;

/* ---- CANVAS DPI FIX ---- */
function resize(){
  const dpr = window.devicePixelRatio || 1;
  canvas.width = innerWidth * dpr;
  canvas.height = innerHeight * dpr;
  canvas.style.width = innerWidth + "px";
  canvas.style.height = innerHeight + "px";
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
resize();
window.addEventListener("resize", resize);

/* ---- HEART SHAPE ---- */
function heartPos(t){
  return [
    Math.pow(Math.sin(t),3),
    -(15*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t))
  ];
}

/* ---- POINTS ---- */
const rand = Math.random;
let points=[], target=[], particles=[];
let dr = isMobile ? 0.3 : 0.1;

function scale(p,sx,sy){
  return [p[0]*sx,p[1]*sy];
}

for(let i=0;i<Math.PI*2;i+=dr){
  points.push(scale(heartPos(i),210,13));
  points.push(scale(heartPos(i),150,9));
  points.push(scale(heartPos(i),90,5));
}

let count = points.length;

/* ---- PARTICLES ---- */
for(let i=0;i<count;i++){
  particles.push({
    vx:0, vy:0,
    q:~~(rand()*count),
    speed:rand()+5,
    force:0.7+0.2*rand(),
    trace:Array.from({length:isMobile?20:50},()=>({
      x:rand()*innerWidth,
      y:rand()*innerHeight
    })),
    color:`hsla(0,${~~(40*rand()+60)}%,${~~(60*rand()+20)}%,.3)`
  });
}

let time=0;

/* ---- PULSE ---- */
function pulse(kx,ky){
  for(let i=0;i<count;i++){
    target[i]=[
      innerWidth/2 + points[i][0]*kx,
      innerHeight/2 + points[i][1]*ky
    ];
  }
}

/* ---- LOOP ---- */
function loop(){
  let n=-Math.cos(time);
  pulse((1+n)*0.5,(1+n)*0.5);
  time+=0.01;

  ctx.fillStyle="rgba(0,0,0,.15)";
  ctx.fillRect(0,0,innerWidth,innerHeight);

  particles.forEach(p=>{
    let q=target[p.q];
    let dx=p.trace[0].x-q[0];
    let dy=p.trace[0].y-q[1];
    let len=Math.sqrt(dx*dx+dy*dy)||1;

    p.vx+=-dx/len*p.speed;
    p.vy+=-dy/len*p.speed;

    p.trace[0].x+=p.vx;
    p.trace[0].y+=p.vy;

    p.vx*=p.force;
    p.vy*=p.force;

    for(let i=p.trace.length-1;i>0;i--){
      p.trace[i].x+=0.4*(p.trace[i-1].x-p.trace[i].x);
      p.trace[i].y+=0.4*(p.trace[i-1].y-p.trace[i].y);
    }

    ctx.fillStyle=p.color;
    p.trace.forEach(t=>ctx.fillRect(t.x,t.y,1,1));
  });

  requestAnimationFrame(loop);
}
loop();
}

document.readyState==="loading"
?document.addEventListener("DOMContentLoaded",init)
:init();
</script>

</body>
</html>
